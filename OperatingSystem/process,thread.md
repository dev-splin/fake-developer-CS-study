### 프로그램 ?

메모리에 올라가 있지 않은 정적인 상태 → 운영체제가 프로그램에 독립적인 메모리 공간을 할당해주지 않았다. 따라서 실행되지 않고 있는 상태라는 의미이다.

메모리에 올리고 동적인 상태의 프로그램을 프로세스라고 한다. 따라서 **프로세스** 는 실행되고 있는 컴퓨터 프로그램 이라고 정의를 내려도 무방하다. 

### 프로세스 ? 스레드 ?

프로세스 ⇒ 운영체제로부터 자원( 프로세서, 필요한 주소 공간, 메모리 )을 할당받는 작업의 단위

스레드 ⇒ 프로세스가 할당받은 자원을 이용하는 실행의 단위.. 한 프로세스 내에서 동작되는 여러 실행의 흐름


               프로세스 내의 주소 공간이나 자원들을 같은 프로세스 내에 스레드끼리 공유하면서 실행된다. 

- 멀티 프로세스 → 멀티 스레드로 변환하여 실행할 경우

    * 프로세스를 생성하여 자원을 할당하는 시스템 콜이 줄어들어 자원을 효율적으로 관리할 수 있다. 

    * 프로세스 간의 통신보다 스레드 간의 통신의 비용이 적기 때문에 작업들 간의 통신의 부담이 줄어든다. 

      [ But ! 스레드 간의 자원 공유는 전역 변수를 이용하기 때문에 동기화 문제에 신경을 써야 한다. ]

운영체제가 프로세스마다 자신에게 할당된 메모리 내의 정보에만 접근할 수 있도록 제약을 두었기 때문에 프로세스보다 더 작은 실행 단위 개념인 스레드가 도입되었다. 따라서, 스레드는 서로간에 메모리를 공유하며 작동한다. 스레드끼리 프로세스의 자원을 공유하면서 프로세스 실행 흐름의 일부가 되는 것이다. 

운영 체제는 프로세스마다 각각 독립된 메모리 영역을 CDSH ( Code, Data, Stack, Heap 의 약자 이후 동일하게 칭한다. ) 형식으로 할당한다. 

스레드는 메모리 영역 내에서 Stack 형식으로 할당된 메모리 영역은 따로 할당받고, 나머지 CDH 형식으로 할당된 메모리 영역을 공유한다. 

CDH 영역을 공유하기 때문에, 어떤 스레드 하나에서 오류가 발생하면 같은 프로세스 내 다른 스레드 모두가 강제로 종료된다. 

               * CPU ⇒ 스레드를 최소 작업단위로.
               * 운영체제 ⇒ 프로세스를 최소 작업 단위로

---

[*] 프로그램 : 어떤 작업을 위해 운영체제 위에서 실행할 수 있는 파일

[*] 프로세스 : 운영체제 위에서 실행중인 프로그램

[*] 프로세서 : 프로세스가 동작될 수 있도록 하는 하드웨어 ( = cpu )

#### __멀티 태스킹이란 ... ?__

CPU는 한순간에 하나의 프로세스만 실행할 수 있음.

운영체제가 짧은 시간에 수천번 실행할 프로세스를 교체하고 있어, 동시에 여러 가지의 작업을 진행하고 있다고 느낄 수 있음. 

#### __멀티 프로세스란 ... ?__

각 프로세스가 각각의 메모리 영역을 가지고 있어 비효율이 발생한다. SHDC 영역을 따로 가지고 있어 재로딩하는 작업이 발생한다. 또한 다른 프로세스 정보를 이용하기 위해서 통신이 필요하다. 

→ 이를 해결하기 위해 스레드로 해결 ... CDH 영역을 공유한다.  

#### __멀티 스레드란 ... ?__

하나의 프로세스가 여러 작업을 여러 스레드를 사용하여 동시에 처리하는 것을 의미한다. 

#### *[*] 멀티 스레드의 장점*

1. Context-Switching 할 때 공유하고 있는 메모리 만큼의 메모리 자원을 아낄 수 있다. 

    → 프로세스 간의 Context-Switching은 많은 자원 손실이 발생한다. 해서, 스레드를 이용한 Context-Switching을 채택하여 메모리를 공유하고 있는 만큼의 부담을 덜 수 있다.

2. 스레드는 프로세스 내 Stack 영역을 제외한 모든 메모리를 공유하기 때문에 통신의 부담이 적어, 응답 시간이 빠르다. 

#### *[*] 멀티 스레드의 단점*

1. 스레드 하나가 프로세스 내 자원을 망쳐버린다면 모든 프로세스가 종료될 수 있다. 
2. 자원을 공유하기 때문에 필연적으로 **동기화 문제**가 발생할 수 밖에 없다.

→ A라는 스레드가 어떤 자원을 사용하다가 B 스레드로 제어권이 넘어간 후 B 스레드가 해당 자원을 수정했을 때, 다시 제어권을 받은 A 스레드가 해당 자원에 접근하지 못하거나 바뀐 자원에 접근하게 되는 오류 발생 가능

사실... 프로세스 간의 정보 공유도 가능하다. 다만, CPU 레지스터 교체 뿐만이 아니라 RAM/CPU 사이의 캐시 메모리까지 초기화되기 때문에 자원 부담이 크다. 

1. IPC ( Inter-Process Communication )을 사용한다. → 파이프나 파일, 소켓이 이헤 해당한다.
2. LPC( Local inter-Process Communication)을 사용한다.
3. 별도로 공유 메모리를 만들어서 정보를 주고받도록 설정해 준다.



### 질문 답변

Q1.멀티 프로세스를 사용할 때, 각각의 프로세스를 독립적으로 사용하게 되는데, 이 경우 프로세스가 스레드를 1개만 가지고 있는 것인가요??

→ 결국 프로세스는 운영체제로부터 자원을 할당받는 작업의 단위이고 쓰레드는 프로세스가 할당받은 자원을 이용하는 실행의 단위이기 때문에 **프로세스를 독립적으로 사용한다는 것은 프로세스가 1개의 실행 단위(쓰레드)만을 가지는 것**입니다.

Q2.멀티스레드에서 sycronization은 필수적인 것 인가?

→ 필수적이다 . 스레드 간 공유 자원으로 사용하고 있는 데이터가 있을 경우, 여러 개의 스레드가 하나의 데이터에 접근할 경우 신뢰성을 보장할 수 없다.

상황에 맞는 스레드 모델을 사용하여야한다.

다양한 요인들이 결합된 데이터에 대한 통계적 분석 연산의 경우는 멀티 스레드 모델이 더 적합하다.
필요한 구간에 여러 개의 스레드를 배치해 시스템 자원을 최대한 활용하여 빠르게 연산을 완료하도록 설계 할 수 있다.
요청에 대한 빠른 반응을 요구하는 네트워크 서버의 프로그램일 경우 단일 스레드 모델이 더 적합 할 수도 있다.
